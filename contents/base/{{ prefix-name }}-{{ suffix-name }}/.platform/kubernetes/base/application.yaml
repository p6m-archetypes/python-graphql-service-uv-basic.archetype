apiVersion: meta.p6m.dev/v1alpha1
kind: PlatformApplication
metadata:
  name: {{ prefix-name }}-{{ suffix-name }}
  labels:
    p6m.dev/app: {{ prefix-name }}-{{ suffix-name }}
spec:
  config:
    GRAPHQL_PORT: "8000"
    MANAGEMENT_PORT: "8080"
    LOGGING_STRUCTURED: "true"
  deployment:
    image: {{ prefix-name }}-{{ suffix-name }}-server:latest
    ports:
      - protocol: http
        port: 8000
      - protocol: http
        port: 8080
    readinessProbe:
      port: 8080
      path: /health

  networking:
    inbound:
      services:
        - name: {{ prefix-name }}-{{ suffix-name }}
          namespace: {{ prefix-name }}-{{ suffix-name }}
          port: 8000